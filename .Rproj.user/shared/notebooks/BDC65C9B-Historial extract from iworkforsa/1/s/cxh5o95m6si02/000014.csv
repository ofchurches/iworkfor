"0","departments_data <- advertiments_title %>%"
"0","  group_by(Division, `Defined as a data job`) %>%"
"0","  count(name = ""Number of advertisments in division"") %>%"
"0","  ungroup() %>%"
"0","  complete(Division, `Defined as a data job`, fill = list(`Number of advertisments in division` = 0)) %>%"
"0","  group_by(Division) %>%"
"0","  mutate(""Division total"" = sum(`Number of advertisments in division`)) %>%"
"0","  ungroup() %>%"
"0","  mutate(""Percent"" = (`Number of advertisments in division`/`Division total`)*100)"
"0","most_data_departments <- departments_data %>%"
"0","  filter(`Defined as a data job` == ""Data"") %>%"
"0","  slice_max(order_by = Percent, n = 12) %>%"
"0","  pull(Division)"
"0","departments_data  %>%"
"0","  filter(Division %in% most_data_departments) %>%"
"0","  mutate(Division = factor(Division, levels = most_data_departments, ordered = TRUE)) %>%"
"0","  ggplot(aes(x = Division, "
"0","             y = Percent, "
"0","             fill = `Defined as a data job`)) + "
"0","  geom_col(position = ""dodge"") + "
"0","  labs(title = ""Divisions with the greatest proportion of 'data' job advertiments"", "
"0","       x = """") + "
"0","  scale_x_discrete(limits=rev) +"
"0","  coord_flip()"
